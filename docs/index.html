<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Au Jour Le Jour — Essentials tracker</title>
    <meta name="description" content="Essentials bill tracker." />
    <link rel="icon" href="./favicon.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="brand">
        <div class="brand-mark">AJL</div>
        <div>
          <div class="brand-title">Au Jour Le Jour</div>
          <div class="brand-sub">Essentials tracker</div>
        </div>
      </div>

      <div class="month-nav">
        <button id="prev-month" class="icon-btn" aria-label="Previous month">&#x2039;</button>
        <input id="month-picker" class="month-input" type="month" />
        <button id="next-month" class="icon-btn" aria-label="Next month">&#x203A;</button>
      </div>

      <div class="top-actions">
        <button id="share-open" class="ghost-btn local-only">Share</button>
        <label class="toggle">
          <input id="essentials-toggle" type="checkbox" checked />
          <span>Essentials only</span>
        </label>
        <nav class="mode-tabs">
          <button id="nav-today" class="tab-btn active">Today</button>
          <button id="nav-review" class="tab-btn">Review</button>
          <button id="nav-setup" class="tab-btn">Setup</button>
        </nav>
      </div>
    </header>

    <main class="container">
      <div id="system-banner" class="system-banner hidden"></div>
      <div id="shared-header" class="shared-header hidden">
        <div class="shared-left">
          <div class="shared-title">Shared list</div>
          <div id="shared-owner" class="shared-owner"></div>
        </div>
        <div class="shared-badge">Read-only</div>
      </div>
      <section id="today-view" class="view">
        <div id="zero-state" class="zero-state hidden">
          <div class="zero-card">
            <div class="zero-title">No bills yet.</div>
            <div class="zero-sub">Add essentials to generate your monthly list.</div>
            <button id="zero-templates-btn" class="primary-btn">Go to Setup</button>
          </div>
        </div>

        <div class="today-layout">
          <div class="today-main">
            <div id="status-bar" class="status-bar">
              <div class="status-metrics">
                <div class="status-count"><span id="count-remaining">0</span> Remaining</div>
                <div class="status-count overdue"><span id="count-overdue">0</span> Overdue</div>
                <div class="status-count soon"><span id="count-soon">0</span> Due soon</div>
                <div class="status-amount"><span id="mini-remaining-amount">$0.00</span> Remaining $</div>
                <div class="status-amount"><span id="mini-done-amount">$0.00</span> Done $</div>
              </div>
              <div id="status-period" class="status-period"></div>
              <button id="status-expand" class="ghost-btn">View summary</button>
            </div>

            <div id="summary-panel" class="summary-panel collapsed">
              <div class="summary-panel-card">
                <div class="summary-panel-title">Monthly summary</div>
                <div class="summary-panel-sub">Reference totals only.</div>
                <div class="summary-grid">
                  <div class="summary-item">
                    <div class="summary-label">Required</div>
                    <div id="required-amount" class="summary-value">$0.00</div>
                  </div>
                  <div class="summary-item">
                    <div class="summary-label">Done</div>
                    <div id="paid-amount" class="summary-value">$0.00</div>
                  </div>
                  <div class="summary-item">
                    <div class="summary-label">Remaining</div>
                    <div id="remaining-amount" class="summary-value">$0.00</div>
                  </div>
                  <div class="summary-item">
                    <div class="summary-label">Plan pace (day)</div>
                    <div id="need-day" class="summary-value">$0.00</div>
                    <div id="need-day-plan" class="summary-caption">Planning avg: $0.00/day</div>
                  </div>
                  <div class="summary-item">
                    <div class="summary-label">Plan pace (week)</div>
                    <div id="need-week" class="summary-value">$0.00</div>
                    <div id="need-week-plan" class="summary-caption">Planning avg: $0.00/week</div>
                  </div>
                </div>
                <div class="summary-counts">
                  <div>Remaining: <span id="summary-count-remaining">0</span></div>
                  <div>Overdue: <span id="summary-count-overdue">0</span></div>
                  <div>Due soon: <span id="summary-count-soon">0</span></div>
                  <div>Done: <span id="summary-count-done">0</span></div>
                </div>
              </div>
            </div>

            <div id="first-visit-hero" class="first-visit-hero hidden">
              <div class="first-visit-card">
                <div class="first-visit-eyebrow">Private bill tracker</div>
                <h1>Know what’s due. Stay in control.</h1>
                <p>Au Jour Le Jour gives you a clear monthly view of your bills so you always know what’s coming up, what’s overdue, and what’s already handled — without connecting to your bank accounts.</p>
                <ul>
                  <li>Clear monthly view of upcoming and overdue bills</li>
                  <li>Fast mark-done workflow with full history</li>
                  <li>Local-first with export and backup control</li>
                </ul>
                <div id="first-visit-web-note" class="first-visit-note hidden">Web version stores data in your browser. Export backups regularly.</div>
                <div class="first-visit-actions">
                  <button id="first-visit-import" class="primary-btn">Import your backup</button>
                  <button id="first-visit-template" class="ghost-btn">Create your first template</button>
                </div>
                <button id="first-visit-continue" class="link-btn">Continue without setup</button>
                <div class="first-visit-trust">No financial connections. Your data stays under your control.</div>
              </div>
            </div>

            <section class="card action-queue" id="action-queue">
              <div class="queue-header">
                <div>
                  <div class="queue-title">Action Queue</div>
                  <div id="queue-subtitle" class="queue-sub">Overdue: 0 items</div>
                </div>
                <div class="queue-actions">
                  <button id="mark-all-overdue" class="btn-small btn-primary readonly-hide">Mark all overdue done</button>
                  <button id="mark-all-soon" class="btn-small ghost-btn readonly-hide">Mark all due soon done</button>
                </div>
              </div>

              <div class="queue-section">
                <div class="queue-section-title">Overdue</div>
                <div id="queue-overdue" class="queue-list"></div>
              </div>
              <div class="queue-section">
                <div class="queue-section-title">Due next 7 days</div>
                <div id="queue-soon" class="queue-list"></div>
              </div>
              <div class="queue-section">
                <div class="queue-section-title">
                  <span>Later</span>
                  <button id="toggle-later" class="ghost-btn small">Hide</button>
                </div>
                <div id="queue-later" class="queue-list"></div>
              </div>
            </section>

            <section id="recent-strip" class="recent-strip hidden"></section>

            <section id="items-card" class="card all-items">
              <div class="card-title">Bills list</div>
              <div class="filter-bar">
                <input id="search-input" class="search-input" type="search" placeholder="Search bills..." />
              <div id="preset-chips" class="chip-group preset-chips">
                <button class="chip" data-preset="due_soon">Due soon</button>
                <button class="chip" data-preset="overdue">Overdue</button>
                <button class="chip" data-preset="this_week">This week</button>
                <button class="chip" data-preset="skipped">Skipped</button>
              </div>
              <div class="chip-group" id="status-chips">
                <button class="chip active" data-status="all">All</button>
                <button class="chip" data-status="pending">Pending</button>
                <button class="chip" data-status="partial">Partial</button>
                <button class="chip" data-status="paid">Done</button>
                <button class="chip" data-status="skipped">Skipped</button>
              </div>
              <button id="filter-open" class="ghost-btn small filter-btn">Filters</button>
              <select id="category-filter" class="select">
                <option value="all">All categories</option>
              </select>
              <select id="sort-filter" class="select">
                <option value="due_date">Due date</option>
                  <option value="amount">Amount</option>
                  <option value="name">Name</option>
                  <option value="status">Status</option>
                </select>
              </div>
              <div id="items-list" class="items-list"></div>
            </section>
          </div>

          <aside id="details-pane" class="details-pane hidden">
            <div id="details-pane-empty" class="details-empty">
              Select a bill to see details.
            </div>
          </aside>
        </div>

        <div id="filter-sheet" class="sheet hidden">
          <div class="sheet-card">
            <div class="sheet-header">
              <div>
                <div class="sheet-title">Filters</div>
                <div class="sheet-sub">Adjust list filtering.</div>
              </div>
              <button id="filter-close" class="icon-btn" aria-label="Close">&times;</button>
            </div>
            <div class="sheet-section">
              <div class="section-title">Status</div>
              <div id="filter-status" class="chip-group">
                <button class="chip" data-status="all">All</button>
                <button class="chip" data-status="pending">Pending</button>
                <button class="chip" data-status="partial">Partial</button>
                <button class="chip" data-status="paid">Done</button>
                <button class="chip" data-status="skipped">Skipped</button>
              </div>
            </div>
            <div class="sheet-section">
              <label>
                Category
                <select id="filter-category" class="select"></select>
              </label>
            </div>
            <div class="sheet-section">
              <label>
                Sort
                <select id="filter-sort" class="select">
                  <option value="due_date">Due date</option>
                  <option value="amount">Amount</option>
                  <option value="name">Name</option>
                  <option value="status">Status</option>
                </select>
              </label>
            </div>
            <div class="sheet-actions">
              <button id="filter-apply" class="btn-small btn-primary">Apply</button>
            </div>
          </div>
        </div>
      </section>

      <section id="review-view" class="view hidden">
        <div class="page-title">Review</div>
        <div class="page-sub">Activity and trends for this month.</div>
        <div class="review-filters">
          <button class="chip" data-review-range="today">Today</button>
          <button class="chip" data-review-range="week">7d</button>
          <button class="chip active" data-review-range="month">Month</button>
        </div>
        <div id="review-activity" class="card">
          <div class="card-title">Activity Log</div>
          <div id="review-activity-list" class="list"></div>
        </div>
        <div id="review-card" class="card">
          <div class="card-header">
            <div class="card-title">Month review</div>
            <button id="review-export" class="ghost-btn small">Export review CSV</button>
          </div>
          <div id="review-summary" class="review-grid"></div>
          <div id="review-list" class="list"></div>
        </div>
      </section>

      <section id="setup-view" class="view hidden">
        <div class="page-title">Setup</div>
        <div class="page-sub">Templates, categories, backups, and reserved buckets.</div>
        <div class="disclaimer">This app tracks bills. You pay outside the app.</div>
        <section class="setup-block web-only">
          <div class="block-title">Install locally</div>
          <div class="block-sub">Want the full local version? Install from GitHub and run it on your machine.</div>
          <div class="meta">
            <div><a href="https://github.com/Fuzzyslippers412/AuJourLeJour" target="_blank" rel="noopener">GitHub repo</a></div>
            <pre class="install-code">git clone https://github.com/Fuzzyslippers412/AuJourLeJour.git
cd AuJourLeJour
./start.sh</pre>
          </div>
        </section>

        <section id="setup-cta" class="setup-block setup-cta hidden">
          <div class="block-title">You’re almost ready</div>
          <div class="block-sub">Import a backup or add your first template to get started.</div>
          <div class="backup-actions">
            <button id="cta-import" class="primary-btn">Import backup</button>
            <button id="cta-template" class="ghost-btn">Create template</button>
          </div>
        </section>

        <section id="backup-section" class="setup-block">
          <div class="block-title">Backup & Restore</div>
          <div class="block-sub">Keep your tracker portable. Export saves everything.</div>
          <div class="backup-actions">
            <button id="export-backup" class="primary-btn">Export backup JSON</button>
            <button id="export-month" class="ghost-btn">Export month CSV</button>
            <button id="export-sqlite" class="ghost-btn local-only">Export SQLite</button>
          </div>
          <div id="backup-last" class="meta">No backup saved yet.</div>

          <div class="import-panel readonly-hide">
            <div id="backup-drop" class="drop-zone">
              Drop your backup JSON here (desktop)
            </div>
            <div class="import-pick-row">
              <button id="import-pick" class="ghost-btn">Choose JSON file</button>
              <input id="import-backup" type="file" accept="application/json" hidden />
            </div>
            <div id="import-preview" class="import-preview hidden">
              <div class="import-title">Import preview</div>
              <div id="import-summary" class="import-summary"></div>
              <div id="import-conflicts" class="meta"></div>
              <div class="import-mode">
                <div class="section-title">Import mode</div>
                <div id="import-mode" class="chip-group">
                  <button class="chip active" data-mode="merge">Merge</button>
                  <button class="chip" data-mode="replace">Replace</button>
                </div>
                <div class="meta">Merge keeps existing items when conflicts occur.</div>
              </div>
              <button id="import-confirm" class="btn-small btn-primary" disabled>Confirm import</button>
            </div>
          </div>
          <div id="storage-health" class="meta"></div>
        </section>

        <section id="local-tools" class="setup-block local-only">
          <div class="block-title">Local tools</div>
          <div class="block-sub">LAN access and direct database download.</div>
          <div class="lan-row">
            <div class="meta">LAN access</div>
            <div id="lan-url" class="mono">—</div>
            <button id="lan-copy" class="ghost-btn">Copy</button>
          </div>
        </section>

        <section class="setup-block">
          <div class="block-title">Defaults</div>
          <div class="block-sub">Period view, sort order, and due-soon window.</div>
          <div class="defaults-grid">
            <label>
              Default period
              <select id="defaults-period" class="select">
                <option value="month">Month</option>
              </select>
            </label>
            <label>
              Default sort
              <select id="defaults-sort" class="select">
                <option value="due_date">Due date</option>
                <option value="amount">Amount</option>
                <option value="name">Name</option>
                <option value="status">Status</option>
              </select>
            </label>
            <label>
              Due soon window (days)
              <input id="defaults-due-soon" type="number" min="1" max="31" />
            </label>
            <button id="save-defaults" class="ghost-btn">Save defaults</button>
          </div>
        </section>

        <section class="setup-block">
          <div class="block-title">Categories</div>
          <div class="block-sub">Manage categories used for filtering.</div>
          <div class="categories-row readonly-hide">
            <input id="category-input" type="text" placeholder="Add category" />
            <button id="category-add" class="ghost-btn">Add</button>
          </div>
          <div id="categories-list" class="categories-list"></div>
        </section>

        <section class="setup-block">
          <div class="block-header">
            <div>
              <div class="block-title">Recurring bills</div>
              <div class="block-sub">These generate your monthly checklist.</div>
            </div>
            <button id="open-backup" class="ghost-btn">Backup &amp; Restore</button>
          </div>
          <form id="template-form" class="template-form readonly-hide">
            <input id="template-name" type="text" placeholder="Name" required />
            <input id="template-category" type="text" placeholder="Category" />
            <input id="template-amount" type="number" min="0" step="0.01" placeholder="Amount" required />
            <input id="template-due-day" type="number" min="1" max="31" placeholder="Due day" required />
            <label class="toggle small">
              <input id="template-essential" type="checkbox" checked />
              <span>Essential</span>
            </label>
            <label class="toggle small">
              <input id="template-active" type="checkbox" checked />
              <span>Active</span>
            </label>
            <input id="template-note" type="text" placeholder="Default note" />
            <input id="template-match-key" type="text" placeholder="Match key" />
            <input id="template-match-tolerance" type="number" min="0" step="0.01" placeholder="Match tolerance" />
            <button class="primary-btn" type="submit">Add bill</button>
          </form>
          <div id="template-error" class="form-error hidden"></div>

          <div class="template-actions readonly-hide">
            <label class="toggle small">
              <input id="select-all-templates" type="checkbox" />
              <span>Select all</span>
            </label>
            <button id="archive-selected" class="ghost-btn" disabled>Archive selected</button>
            <button id="delete-selected" class="ghost-btn" disabled>Delete selected</button>
            <button id="apply-templates" class="ghost-btn">Apply template updates to this month</button>
          </div>

          <div id="templates-list" class="templates-list"></div>
        </section>

        <section id="funds-section" class="setup-block">
          <div class="block-title">Reserved buckets</div>
          <div class="block-sub">Sinking funds for yearly or quarterly obligations.</div>

          <form id="fund-form" class="template-form readonly-hide">
            <input id="fund-name" type="text" placeholder="Name" required />
            <input id="fund-category" type="text" placeholder="Category" />
            <input id="fund-target" type="number" min="0" step="0.01" placeholder="Target amount" required />
            <input id="fund-due-date" type="date" required />
            <select id="fund-cadence" class="select">
              <option value="yearly">Yearly</option>
              <option value="quarterly">Quarterly</option>
              <option value="custom_months">Custom months</option>
            </select>
            <input id="fund-months" type="number" min="1" step="1" placeholder="Months per cycle" />
            <label class="toggle small">
              <input id="fund-essential" type="checkbox" checked />
              <span>Essential</span>
            </label>
            <label class="toggle small">
              <input id="fund-auto" type="checkbox" checked />
              <span>Auto contribute</span>
            </label>
            <label class="toggle small">
              <input id="fund-active" type="checkbox" checked />
              <span>Active</span>
            </label>
            <button class="primary-btn" type="submit">Add bucket</button>
          </form>
          <div id="fund-error" class="form-error hidden"></div>
          <div id="funds-list" class="templates-list"></div>
        </section>

        <section class="setup-block">
          <div class="block-title">Preview</div>
          <div class="block-sub">Simulate read-only sharing on this device.</div>
          <label class="toggle">
            <input id="preview-readonly" type="checkbox" />
            <span>Preview read-only mode</span>
          </label>
        </section>

        <section class="setup-block">
          <div class="block-title">Data safety</div>
          <div class="block-sub">Reset local data or start in safe mode if something breaks.</div>
          <div id="integrity-status" class="meta">Integrity: Unknown</div>
          <div class="safety-actions readonly-hide">
            <button id="clear-filters" class="ghost-btn">Clear filters</button>
            <button id="reset-local-inline" class="ghost-btn danger">Reset local data</button>
            <button id="start-safe-mode" class="ghost-btn">Start in safe mode</button>
          </div>
        </section>
      </section>
    </main>

    <div id="share-modal" class="modal hidden local-only">
      <div class="modal-content">
        <div class="modal-header">
          <div>
            <div class="modal-title">Share read-only link</div>
            <div class="modal-sub">Anyone with this link can view your list.</div>
          </div>
          <button id="share-close" class="icon-btn" aria-label="Close">&times;</button>
        </div>
        <div class="modal-actions">
          <div class="share-row">
            <input id="share-link" class="share-link" type="text" readonly />
            <button id="share-copy" class="btn-small btn-primary">Copy link</button>
          </div>
          <label class="toggle">
            <input id="share-live" type="checkbox" checked />
            <span>Live updates</span>
          </label>
          <div class="share-actions">
            <button id="share-create" class="ghost-btn">Create link</button>
            <button id="share-regenerate" class="ghost-btn">Regenerate link</button>
            <button id="share-disable" class="ghost-btn danger">Disable link</button>
          </div>
          <div class="modal-footer-hint">
            This link is read-only.
          </div>
        </div>
      </div>
    </div>

    <div id="first-run-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <div>
            <div class="modal-title">Get started</div>
            <div class="modal-sub">Import a backup or create your first template.</div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="wizard-import" class="primary-btn">Import backup JSON</button>
          <button id="wizard-template" class="ghost-btn">Add first template</button>
          <button id="wizard-skip" class="ghost-btn">Skip for now</button>
          <input id="wizard-file" type="file" accept="application/json" hidden />
        </div>
      </div>
    </div>

    <div id="details-drawer" class="drawer hidden">
      <div class="drawer-scrim" data-close="details"></div>
      <div class="drawer-panel">
        <div class="drawer-header">
          <div>
            <div id="detail-name" class="drawer-title">Bill</div>
            <div id="detail-meta" class="drawer-sub">Due</div>
          </div>
          <button class="icon-btn" data-close="details" aria-label="Close">&times;</button>
        </div>
        <div class="drawer-body">
          <div class="drawer-actions readonly-hide">
            <button id="detail-mark-done" class="btn-primary">Mark done</button>
            <button id="detail-skip" class="ghost-btn">Mark skipped</button>
          </div>
          <div class="drawer-section readonly-hide">
            <div class="section-title">Log update</div>
            <div class="log-update-row">
              <input id="detail-log-amount" type="number" min="0" step="0.01" placeholder="Amount completed" />
              <button id="detail-log-submit" class="btn-small btn-primary">Log update</button>
            </div>
            <div id="detail-log-status" class="meta"></div>
          </div>
          <div class="drawer-section readonly-hide">
            <div class="section-title">Edit bill</div>
            <div class="drawer-grid">
              <label>
                Name
                <input id="detail-edit-name" type="text" />
              </label>
              <label>
                Category
                <input id="detail-edit-category" type="text" />
              </label>
              <label>
                Amount
                <input id="detail-edit-amount" type="number" min="0" step="0.01" />
              </label>
              <label>
                Due date
                <input id="detail-edit-due" type="date" />
              </label>
            </div>
            <label>
              Notes
              <textarea id="detail-edit-note" rows="3"></textarea>
            </label>
            <button id="detail-save" class="btn-small">Save changes</button>
            <div id="detail-save-status" class="meta"></div>
          </div>
          <div class="drawer-section readonly-hide">
            <div class="section-title">Activity</div>
            <div id="detail-history" class="list"></div>
          </div>
        </div>
      </div>
    </div>

    <div id="toast" class="toast hidden">
      <div id="toast-message" class="toast-message"></div>
      <button id="toast-action" class="toast-action hidden">Undo</button>
    </div>

    <button id="assistant-fab" class="fab local-only">Mamdou</button>
    <div id="assistant-drawer" class="drawer hidden local-only">
      <div class="drawer-scrim" data-close="assistant"></div>
      <div class="drawer-panel assistant-sheet">
        <div class="drawer-header">
          <div>
            <div class="drawer-title">Mamdou</div>
            <div class="drawer-sub">Commands, suggestions, and intake.</div>
          </div>
          <button class="icon-btn" data-close="assistant" aria-label="Close">&times;</button>
        </div>
        <div class="drawer-body">
          <div id="assistant-connection" class="assistant-connection">
            <div class="assistant-connection-text">
              <div id="assistant-connection-title" class="assistant-connection-title">Connect Mamdou</div>
              <div id="assistant-connection-body" class="assistant-connection-body">Use Mamdou login to enable insights.</div>
            </div>
            <div id="assistant-connection-action" class="assistant-connection-action"></div>
          </div>
          <textarea id="llm-agent-input" class="assistant-input" rows="3" placeholder="Try: “add Internet $90 on the 3rd” or “mark rent done”"></textarea>
          <div class="assistant-actions">
            <button id="llm-agent-send" class="btn-small btn-primary">Send</button>
          </div>
          <div id="llm-agent-output" class="assistant-status meta"></div>
          <div id="llm-agent-actions" class="assistant-actions-row hidden">
            <button id="llm-agent-confirm" class="btn-pill primary">Confirm</button>
            <button id="llm-agent-cancel" class="btn-pill">Cancel</button>
          </div>
          <div id="llm-agent-history" class="assistant-thread"></div>
          <div class="assistant-log">
            <div class="assistant-log-heading">Command log</div>
            <div id="llm-command-log" class="assistant-log-list"></div>
          </div>
          <button id="llm-chat-clear" class="assistant-clear">Clear chat</button>
        </div>
      </div>
    </div>

    <script src="./web-adapter.js"></script>
    <script src="./app.js"></script>
  </body>
</html>
